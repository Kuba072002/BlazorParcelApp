@page "/admin/locker-add"
@inject HttpClient Http
@inject NavigationManager NavManager
@attribute [Authorize(Roles = "Admin")]

<h3>AddLocker</h3>

<div class="container-fluid">
    <div class="row px-3">
        <div class="col-md-9 p-3">
            <EditForm Model="lockerdto" OnSubmit="OnSubmit">
            <div class="row">
                <div class="col">
                    <div>Name:</div>
                    <InputText @bind-Value="lockerdto.Name" class="form-control"></InputText>
                </div>
                <div class="col">
                    <div>City:</div>
                    <InputText @bind-Value="lockerdto.City" class="form-control"></InputText>
                </div>
                <br/>
                <div class="col">
                    <button type="submit" class="btn btn-primary">
                        <!----<i class="oi oi-cloud-upload"></i>---->
                    </button>
                    <div class="text-danger">
                    <span>@errorMessage</span>
                </div>
                </div>
            </div>
            </EditForm>
        </div>
    </div>
</div>
@code {
    LockerDto lockerdto = new LockerDto();
    private string errorMessage = string.Empty;

    private async Task OnSubmit() {
        var result = await Http.PostAsJsonAsync($"/api/Locker/", lockerdto);

        if (!result.IsSuccessStatusCode) {
            errorMessage = await result.Content.ReadAsStringAsync();
            return;
        }

        NavManager.NavigateTo($"/notes");


    }

}
